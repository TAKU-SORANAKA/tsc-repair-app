<same Python content as before with fixes>